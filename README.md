# RISC-V 32-bit Assembler and Simulator

## Overview
This project provides a lightweight assembler **and** simulator for a subset of the RISC-V 32-bit Instruction Set Architecture. It is ideal for educational purposes and small-scale experiments with RISC-V. The project is divided into two main components:

1. **Assembler:**  
   Reads an assembly source file (`input.asm`), translates the code into machine code, and outputs the result to `output.mc`. The output file contains:
   - **Code Segment:** Each instruction’s address, its machine code in hexadecimal, and a detailed binary field breakdown.
   - **Data Segment:** The initial memory contents as specified by data directives (e.g., `.byte`, `.word`, etc.).

2. **Simulator:**  
   Provides an interactive terminal UI to execute the generated machine code. The simulator:
   - Loads instructions from the machine code file.
   - Simulates the RISC-V processor by updating the CPU registers, program counter, and memory.
   - Displays the state of the register file, key CPU registers, and ALU operation details at each cycle.
   - Offers both step-by-step execution and run-to-end modes.
   - Updates the original input file’s data segment to reflect changes after simulation.

## Features

### Assembler
- **Instruction Support:**  
  - **R-type:** e.g., `add x1, x2, x3`, `sub x4, x5, x6`
  - **I-type:** e.g., `addi x1, x0, 10`, `lb x2, 0(x3)`, `jalr x1, 0(x5)`
  - **S-type:** e.g., `sb x6, 4(x7)`
  - **SB-type (Branch):** e.g., `beq x1, x2, label`, `bne x3, x4, loop`
  - **U-type:** e.g., `lui x5, 0x12345`, `auipc x6, 0xABCD`
  - **UJ-type:** e.g., `jal x1, label`
- **Data Directives:** Supports `.byte`, `.half`, `.word`, `.dword`, and `.asciz` along with section directives (`.text` and `.data`).
- **Detailed Output:** Generates a machine code file with address, hexadecimal representation, and binary breakdown comments.

### Simulator
- **Interactive Terminal UI:**  
  - Choose between stepping through each instruction or running to the end.
  - Displays cycle count, current register states, program counter, instruction register, and ALU/operand details.
- **Comprehensive Simulation:**  
  - Implements instruction fetch, decode, execute, and write-back stages.
  - Supports RISC-V instruction types (R, I, S, SB, U, UJ) with basic arithmetic, logic, memory access, branch, and jump operations.
  - Dynamically updates a data segment and writes changes back to the input file after simulation.

## Project Structure
- **`input.asm`** – The assembly language file to be processed.
- **`output.mc`** – The resulting machine code file generated by the assembler.
- **`phase1.cpp`** – The complete source code for the assembler.
- **`simulator.cpp`** – The source code for the simulator with a terminal UI.

## Compilation & Execution

### Assembler
1. **Compile the Assembler:**
    ```bash
    g++ -std=c++11 phase1.cpp -o assembler
    ```
2. **Run the Assembler:**
    ```bash
    ./assembler
    ```
   The assembler reads `input.asm` and generates `output.mc`, including both code and data segments.

### Simulator
1. **Compile the Simulator:**
    ```bash
    g++ -std=c++11 simulator.cpp -o simulator
    ```
2. **Run the Simulator:**
    ```bash
    ./simulator input.mc
    ```
   Upon execution, the simulator:
   - Loads machine code from `output.mc`.
   - Displays the initial CPU state.
   - Prompts the user to either step through the execution or run continuously.
   - Updates the data segment in the input file after simulation completion.

## Usage Example
Create or edit your assembly file (`input.asm`) using standard RISC-V syntax. For example:
```asm
  .data
  arrayA: .byte 10, 20, 30, 40
  arrayB: .word 3735928559
  
  .text
  main:
      addi x1, x0, 5
      beq  x1, x0, end
      add  x0, x0, x0
  end:
      jal  x0, end

```
**Assemble the code:**  
Run `./assembler` to generate `output.mc`.

**Simulate the code:**  
Run `./simulator input.mc` to execute the machine code with interactive prompts.

## Limitations
- **Pseudoinstructions:** Not supported.
- **Floating-Point Operations:** Not supported.
- **Label Resolution:** Performs static resolution; undefined labels will trigger error messages.
- **Branch/Jump Offsets:** Computed relative to the current instruction address; no dynamic simulation is provided.

## Contributing
Contributions and improvements are welcome. Please fork the repository and submit pull requests for enhancements or bug fixes.

## Contact
For any questions or queries, please contact:
- Hetvi Bagdai (2023csb1123@iitrpr.ac.in)
- Tanisha Gupta (2023csb1170@iitrpr.ac.in)
- Yashashvi Chaudhary (2023csb1174@iitrpr.ac.in)
